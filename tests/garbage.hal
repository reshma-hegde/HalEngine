fun make_junk(var size)
    var arr = [];
    var i = 1;
    while i <= size
        arr[i] = i * 2;
        i = i + 1;
    elihw
    print("Allocated array of size ", size, "\n");
    return 0;
nuf


fun main()
    print("Starting GC stress test...");

    var cycle = 1;
    while cycle <= 5
        
        make_junk(5000);

        if cycle % 2 == 0
            print("Forcing garbage collection...");
            gc_collect();
        fi

        print("Cycle ", cycle, " done");
        cycle = cycle + 1;
    elihw

    print("Finished! If GC works, memory use should stay low.\n");
    return 0;
nuf
